<!DOCTYPE html>
<title>Page Title</title>
<link href="/css/workflow.css" rel="stylesheet"  type="text/css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mustache.js/2.2.1/mustache.js"></script>
<body id="body" ng-controller="workflowController">
<nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
        </div>

        <!--<a class="navbar-brand navbar-center" ng-href="/boards">Boards</a>-->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav">
            <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Menu<span class="caret"></span></a>
                <ul class="dropdown-menu">
                    <li><a ng-href="/boards">Boards</a></li>
                    <li><a href="#">Calendar</a></li>
                    <li><a href="#">Settings</a></li>
                    <li role="separator" class="divider"></li>
                    <li><a href="#">Separated link</a></li>
                    <li role="separator" class="divider"></li>
                    <li><a href="#">One more separated link</a></li>
                </ul>
            </li>
        </ul>
        <form class="navbar-form navbar-left" role="search">
            <input type="text" class="form-control" placeholder="Search">
        </form>
        </div>

    </div>
</nav>
<div class="container">       
   <div id="workflow-container" class="row">
        <!--
        <div class="col-lg-4 col-lg-4">
        <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title">
                            <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne">To-Do</a>
                        </h4>
                    </div>
                    <div id="collapseOne" class="panel-collapse collapse in">
                        <div class="panel-body">
                                <ul class="list-group">
                                    <li class="list-group-item">
                                        <a href="#" class="task-link">
                                        <div style="word-wrap: break-word; margin-right: 7px;">
                                        Walk my dog
                                        </div>
                                        <span class="show-menu">
                                            <span class="glyphicon glyphicon-chevron-right"></span>
                                        </span>
                                        </a>
                                    </li>
                                    <li class="list-group-item">
                                        <a href="#" class="task-link">
                                        Complete Project
                                        <span class="show-menu">
                                            <span class="glyphicon glyphicon-chevron-right"></span>
                                        </span>
                                        <ul class="list-group-submenu">
                                            <li class="list-group-submenu-item primary"><span class="glyphicon glyphicon-remove"></span></li>
                                            <li class="list-group-submenu-item warning"><span class="glyphicon glyphicon-ok"></span></li>
                                        </ul>
                                        </a>
                                    </li>
                                    <li class="list-group-item">
                                        <a href="#" class="task-link">
                                        Grab a Beer with Friends.
                                        <span class="show-menu">
                                            <span class="glyphicon glyphicon-chevron-right"></span>
                                        </span>
                                        <ul class="list-group-submenu">
                                            <li class="list-group-submenu-item info"><span class="glyphicon glyphicon-remove"></span></li>
                                            <li class="list-group-submenu-item"><span class="glyphicon glyphicon-ok"></span></li>
                                        </ul>
                                        </a>
                                    </li>
                                </ul>
                                <button id="add-task-button" class="btn btn-circle pull-right" ng-click="createNewTaskButtonClicked(this)">
                                    <i class="glyphicon glyphicon-plus"></i>
                                </button>
                            </div>
                        </div>
                </div>
        </div>
        <div class="col-lg-4 col-lg-4">
        <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title">
                            <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne">Pending</a>
                        </h4>
                    </div>
                    <div id="collapseOne" class="panel-collapse collapse in">
                        <div class="panel-body">
                                <ul class="list-group">
                                    <li class="list-group-item">
                                        <a href="#" class="task-link">
                                        Vet Appointment!
                                        <span class="show-menu">
                                            <span class="glyphicon glyphicon-chevron-right"></span>
                                        </span>
                                        <ul class="list-group-submenu">
                                            <li class="list-group-submenu-item success"><span class="glyphicon glyphicon-remove"></span></li>
                                            <li class="list-group-submenu-item danger"><span class="glyphicon glyphicon-ok"></span></li>
                                        </ul>
                                        </a>
                                    </li>
                                    <li class="list-group-item">
                                        <a href="#" class="task-link">
                                        Complete Project
                                        <span class="show-menu">
                                            <span class="glyphicon glyphicon-chevron-right"></span>
                                        </span>
                                        <ul class="list-group-submenu">
                                            <li class="list-group-submenu-item primary"><span class="glyphicon glyphicon-remove"></span></li>
                                            <li class="list-group-submenu-item warning"><span class="glyphicon glyphicon-ok"></span></li>
                                        </ul>
                                        </a>
                                    </li>
                                    <li class="list-group-item">
                                        <a href="#" class="task-link">
                                        Grab a Beer with Friends.
                                        <span class="show-menu">
                                            <span class="glyphicon glyphicon-chevron-right"></span>
                                        </span>
                                        <ul class="list-group-submenu">
                                            <li class="list-group-submenu-item info"><span class="glyphicon glyphicon-remove"></span></li>
                                            <li class="list-group-submenu-item"><span class="glyphicon glyphicon-ok"></span></li>
                                        </ul>
                                        </a>
                                    </li>
                                </ul>
                                <button id="add-task-button" class="btn btn-circle pull-right" ng-click="createNewTaskButtonClicked()">
                                <i class="glyphicon glyphicon-plus"></i>
                                </button>
                            </div>
                        </div>
                </div>
        </div>
    </div>
    -->
    <!-- Popup View --> 
    <div id="light" class="white_content"><button id="dismiss-popup-button" type="button" class="btn btn-danger btn-md" ng-click = "dismissPopupButtonClicked()"><i class="glyphicon glyphicon-remove"></i></button>
        <form ng-submit="addNewWorkflow()" style="text-align:center; margin-top: 100px;">
            <div class="input-group" style="margin:20px;">
                <span class="input-group-addon success"><span class="glyphicon glyphicon-plus"></span></span>
                <input id="create-new-workflow-input" type="text" class="form-control input-lg" name="validate-optional" placeholder="Type in the name of your new workflow!" ng-model="newWorkflowName" ng-keyup="checkDataInCreateNewWorkflowInput()">
            </div>
            <div style="margin:20px;">
            <button id="create-new-workflow-button" type="submit" class="btn btn-primary col-xs-12 btn-lg" disabled>Create</button>
            </div>
        </form>
    </div>

    <!-- Create Task Popup View -->
    <div id="create-task-popup"><button id="dismiss-create-task-popup-button" type="button" class="btn btn-danger btn-md" ng-click = "dismissCreateTaskPopupButtonClicked()"><i class="glyphicon glyphicon-remove"></i></button>
        <form ng-submit="submitTaskForm()" style="text-align:center; margin-top: 43px;">
            <div class="input-group" style="margin:20px;">
                <span class="input-group-addon success"><span class="glyphicon glyphicon-plus"></span></span>
                <input id="task-name-input" type="text" class="form-control input-lg" name="validate-optional" placeholder="New Task" ng-model="taskFormName" required>
            </div>
            <div class="input-group" style="margin:20px;">
                    <span class="input-group-addon success"><span class="glyphicon glyphicon-pencil"></span></span>
                    <textarea class="form-control" name="description" placeholder="Description" rows="3" ng-model="taskFormDescription"></textarea>    
            </div>
            <div class="input-group" style="margin:20px;">
                    <div style="float:left">
                    <div class="input-group">
                    <span class="input-group-addon success"><span class="glyphicon glyphicon-calendar"></span></span>
                    <input id="create-new-workflow-input" type="date" class="form-control input-lg" ng-model="taskFormDate">
                    <!--Due Date: <input type="date" name="bday">-->
                    </div>
                    </div>
                    <div style="float:right; margin-left:15px;">
                    Priority: <div class="btn-group btn-group-md" role="group" aria-label="...">
                      <button type="button" class="btn btn-success">Low</button>
                      <button type="button" class="btn btn-warning">Medium</button>
                      <button type="button" class="btn btn-danger">High</button>
                    </div>
                    </div>
            </div>
            <div class="input-group" style="margin:20px;">
                <span class="input-group-addon success"><span class="glyphicon glyphicon-user"></span></span>
                <input id="create-new-workflow-input" type="text" class="form-control input-lg" name="validate-optional" placeholder="Assignee" ng-model="assignee" ng-model="taskFormAssignee">
            </div>
            <div style="margin:20px;">
            <button id="create-task-button" type="submit" class="btn btn-primary col-xs-12 btn-lg" ng-disabled="!taskFormName">Create</button>
            </div>
        </form>
    </div>
    <!-- Add Workflow Button -->
    <button id="add-workflow-button" type="button" class="btn btn-circle btn-lg" ng-click="addWorkflowButtonClicked()"><i class="glyphicon glyphicon-plus"></i></button>
    
    <!-- Black Background Overlay for Popup Display -->       
    <div id="fade" class="black_overlay"></div>
</div>

<ul ng-repeat="workflow in workflows" class="workflow-list">
    <li>
        <div id="{{workflow.name}" class='col-lg-4 col-lg-4' ng-model="workflowId">
            <div class='panel panel-default'>
                <div class='panel-heading'>
                    <h4 class='panel-title'><a data-toggle='collapse' data-parent='#accordion' href='#collapseOne'>{{workflow.name}}</a></h4>
                    </div>
                        <div id='collapseOne' class='panel-collapse collapse in'>
                        <div class='panel-body'>
                        <ul class='list-group' ng-repeat="task in workflow.tasks">
                            <li id="{{task._id}}" class="list-group-item task-box">
                                <a href="#" style="text-decoration: none !important;" class="task-link">
                                <p style="word-break:break-all; margin-right: 10px; font-size: medium;">{{task.title}}</p>
                                <p ng-if="task.description" class="task-detail">Details : {{task.description}}</p>
                                <div>{{task.creator.username}}</div>
                                <button type="button" class="btn btn-danger btn-md task-remove-button" ng-click="deleteTask(task._id, workflow)"><i class="glyphicon glyphicon-remove"></i></button>
                                <button type="button" class="btn btn-info btn-md task-edit-button" ng-click="editTask(task, workflow)"><i class="glyphicon glyphicon-cog"></i></button>
                                <button type="button" class="btn btn-info btn-md task-edit-button">50%</button>
                                <button type="button" class="btn btn-default btn-md task-edit-button"><i class="glyphicon glyphicon-calendar"></i>  04/23/16</button>
                                <span class="show-menu">
                                <span class="glyphicon glyphicon-chevron-right" rel="tooltip" title="Tip 1"></span>
                                </span>
                                </a>
                            </li> 
                        </ul>
                        <button id="add-task-button" class="btn btn-circle pull-right" ng-click="addTask(workflow)">
                            <i class="glyphicon glyphicon-plus"></i>
                        </button>
                        </div>
                </div>
            </div>
        </div>        
    </li>   
</ul>
</body>